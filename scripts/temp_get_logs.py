from web3 import Web3
from web3.middleware import geth_poa_middleware

# provider = Web3.IPCProvider("/data/bsc/2/geth/geth.ipc")
# provider = Web3.HTTPProvider("http://127.0.0.1:9545")
provider = Web3.WebsocketProvider("ws://127.0.0.1:9546")
w3 = Web3(provider)
w3.middleware_onion.inject(geth_poa_middleware, layer=0)

filt = {
    "address": ["0xecA88125a5ADbe82614ffC12D0DB554E2e2867C8","0xfD5840Cd36d94D7229439859C0112a4185BC0255","0x95c78222B3D6e262426483D42CfA53685A67Ab9D","0x2fF3d0F6990a40261c66E1ff2017aCBc282EB6d0","0x151B1e2635A717bcDc836ECd6FbB62B674FE3E1D","0xA07c5b74C9B40447a954e1466938b865b6BBea36","0x882C173bC7Ff3b7786CA16dfeD3DFFfb9Ee7847B","0xf508fCD89b8bd15579dc79A6827cB4686A3592c8","0x57A5297F2cB2c0AaC9D554660acd6D385Ab50c6B","0xB248a295732e0225acd3337607cc01068e3b9c10","0x5F0388EBc2B94FA8E123F404b79cCF5f40b29176","0x1610bc33319e9398de5f57B33a5b184c806aD217","0x650b940a1033B8A1b1873f78730FcFC73ec11f1f","0x334b3eCB4DCa3593BCCC3c7EBD1A1C1d1780FBF1","0xf91d58b5aE142DAcC749f58A49FCBac340Cb0343","0x972207A639CC1B374B893cc33Fa251b55CEB7c07","0xeBD0070237a0713E8D94fEf1B728d3d993d290ef","0x9A0AF7FDb2065Ce470D72664DE73cAE409dA28Ec","0xec3422Ef92B2fb59e84c8B02Ba73F1fE84Ed8D71","0x5c9476FcD6a4F9a3654139721c949c2233bBbBc8","0x86aC3974e2BD0d60825230fa6F355fF11409df5c","0x26DA28954763B92139ED49283625ceCAf52C6f94","0x08CEB3F4a7ed3500cA0982bcd0FC7816688084c3","0x61eDcFe8Dd6bA3c891CB9bEc2dc7657B3B422E93","0x78366446547D062f45b4C0f320cDaa6d710D87bb","0xb91A659E88B51474767CD97EF3196A3e7cEDD2c8","0xC5D3466aA484B040eE977073fcF337f2c00071c1"],
    "topics": [
        [
            "0x1a2a22cb034d26d1854bdc6666a5b91fe25efbbb5dcad3b0355478d6f5c362a1",
            "0x13ed6866d4e1ee6da46f845c46d7e54120883d75c5ea9a2dacc1c4ca8984ab80",
            "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
            "0x875352fb3fadeb8c0be7cbbe8ff761b308fa7033470cd0287f02f3436fd76cb9",
            "0x4dec04e750ca11537cabcd8a9eab06494de08da3735bc8871cd41250e190bc04",
            "0xa91e67c5ea634cd43a12c5a482724b03de01e85ca68702a53d0c2f45cb7c1dc5",
            "0x3bad0c59cf2f06e7314077049f48a93578cd16f5ef92329f1dab1420a99c177e",
            "0x70483e6592cd5182d45ac970e05bc62cdcc90e9d8ef2c2dbe686cf383bcd7fc5"
        ]
    ]
}
filt['fromBlock'] = hex(2871511)
filt['toBlock'] = hex(2873511)

try:
    logs = w3.eth.get_logs(filt)
except Exception as e:
    print(f"get logs failed, error: {e}")

print(logs)
